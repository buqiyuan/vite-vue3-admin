import{d as g,r as w,b as k,k as n,B as E,aF as b,aG as L,bs as M,F as j,bA as D}from"./vendor-D7Y6X7_h.js";import{I as O}from"./index-Bf9NpXkZ.js";import{b as F}from"./is-CBsgbGQ7.js";function P(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!M(e)}const S={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default(){return{x:0,y:0}}},items:{type:Array,default(){return[]}}},x=e=>{const{item:o}=e;return n("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,o)},[e.showIcon&&o.icon&&n(O,{class:"mr-2",type:o.icon},null),n("span",null,[o.label])])},_=g({name:"ContextMenu",props:S,setup(e,{expose:o}){const y=w(!0),i=k(()=>{const{axis:s,items:l,styles:t,width:r}=e,{x:u,y:d}=s||{x:0,y:0},v=(l||[]).length*40,p=r,h=document.body,I=h.clientWidth<u+p?u-p:u,C=h.clientHeight<d+v?d-v:d;return{position:"absolute",width:`${r}px`,left:`${I+1}px`,top:`${C+1}px`,...t}}),c=()=>{y.value=!1};function a(s,l){const{handler:t,disabled:r}=s;r||(l?.stopPropagation(),l?.preventDefault(),t?.(),c())}function f(s){return s.filter(t=>!t.hidden).map(t=>{const{disabled:r,label:u,children:d,divider:v=!1}=t,p={item:t,handler:a,showIcon:e.showIcon};return!d||d.length===0?n(j,null,[n(b.Item,{disabled:r,key:u},{default:()=>[n(x,p,null)]}),v?n(b.Divider,{key:`d-${u}`},null):null]):n(b.SubMenu,{key:u,disabled:r},{title:()=>n(x,p,null),default:()=>f(d)})})}return o({close:c}),()=>{const{items:s}=e;return n(L,{open:y.value},{default:()=>n("div",{style:E(i)},null),overlay:()=>{let l;return n(b,{inlineIndent:12,mode:"vertical"},P(l=f(s))?l:{default:()=>[l]})}})}}}),m={domList:[],resolve:()=>{}},B=function(e){const{event:o}=e||{};if(o&&o?.preventDefault(),!!F)return new Promise(y=>{const i=document.body,c=document.createElement("div"),a={getPopupContainer:()=>c};e.styles&&(a.styles=e.styles),e.items&&(a.items=e.items),e.event&&(a.customEvent=o,a.axis={x:o.clientX,y:o.clientY});const f=n(_,a);D(f,c);const s=function(){m.resolve("")};m.domList.push(c);const l=function(){m.domList.forEach(t=>{try{t&&i.removeChild(t)}catch{}}),i.removeEventListener("click",s),i.removeEventListener("scroll",s)};m.resolve=function(t){f.component?.exposed?.close(),l(),y(t)},l(),i.appendChild(c),i.addEventListener("click",s),i.addEventListener("scroll",s)})},H=function(){m&&(m.resolve(""),m.domList=[])};export{B as c,H as d};
