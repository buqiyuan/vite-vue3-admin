import{f as z}from"./index-DKcumURF.js";import{A as h,C}from"./index-Bf9NpXkZ.js";import{f as F}from"./dateUtil-ohqk8BGA.js";import{d as R,r as t,b as y,bS as T,I as A,J as D,K as l,k as s,B as e,Z as J,Q as V,U as L,F as P,_ as E,x as q,a0 as U,ak as N,a3 as W,b0 as b,bn as H,aW as I,S as Z,aS as j,aZ as K}from"./vendor-D7Y6X7_h.js";const O="data:image/png;base64,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",ee=R({name:"FilePreviewDrawer",__name:"file-preview-drawer",setup(X,{expose:k}){const c=new Map([["name","文件名"],["mimeType","文件类型"],["hash","文件Hash"],["md5","文件MD5"],["fsize","文件大小"],["putTime","上传时间"],["uploader","上传人员"]]),m=t(!1),f=t(!1),w=t(""),M=t(""),n=t({}),r=t(""),u=t(""),g=t(!1),v=y(()=>T(r.value)),B=y(()=>`${r.value}?imageView2/2/w/500/h/210`),x=async(i,p)=>{f.value=!0,w.value=i,M.value=p,await q();try{m.value=!0;const d={name:i,path:p},a=await h.netDiskManage.netDiskManageInfo(d);if(u.value=a.mark,Array.from(c.keys()).forEach(o=>{o==="fsize"?n.value.fsize=z(a[o]):n.value[o]=a[o]}),n.value.putTime=F(a.putTime),n.value.name=i,n.value,C("netdisk:manage:download")&&a.mimeType.includes("image/")){const o=await h.netDiskManage.netDiskManageDownload(d);r.value=o}}catch{S()}finally{m.value=!1}},Q=async()=>{try{g.value=!0,await h.netDiskManage.netDiskManageMark({name:w.value,path:M.value,mark:u.value}),U.success("已更新文件备注")}finally{g.value=!1}},S=()=>{w.value="",M.value="",r.value="",u.value="",n.value={},f.value=!1};return k({open:x}),(i,p)=>{const d=N("a-button");return A(),D(e(K),{title:"文件详情",width:500,visible:f.value,onClose:S},{default:l(()=>[s(e(W),{spinning:m.value,class:"preview-drawer-inner-box"},{default:l(()=>[s(e(b),{direction:"vertical"},{default:l(()=>[s(e(H),{style:J({width:v.value?"130px":"100%",height:v.value?"85px":"210px"}),src:v.value?e(O):B.value,preview:v.value?!1:{src:r.value}},null,8,["style","src","preview"]),s(e(I),{bordered:"",column:1,size:"small"},{default:l(()=>[(A(!0),V(P,null,L(e(c).keys(),a=>(A(),D(e(I).Item,{key:a,label:e(c).get(a),"label-style":{whiteSpace:"nowrap"}},{default:l(()=>[E(Z(n.value[a]),1)]),_:2},1032,["label"]))),128)),s(e(I).Item,{label:"文件备注","label-style":{whiteSpace:"nowrap"}},{default:l(()=>[s(e(b),{direction:"vertical",align:"end"},{default:l(()=>[s(e(j).TextArea,{value:u.value,"onUpdate:value":p[0]||(p[0]=a=>u.value=a),disabled:!i.$auth("netdisk:manage:mark"),placeholder:"请输入文件备注",maxlength:100,rows:4,"show-count":""},null,8,["value","disabled"]),s(d,{loading:g.value,disabled:!i.$auth("netdisk:manage:mark"),type:"primary",size:"mini",onClick:Q},{default:l(()=>[E("更新 ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["spinning"])]),_:1},8,["visible"])}}});export{ee as _};
