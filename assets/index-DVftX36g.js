import{b as _}from"./columns-4AKd_GF8.js";import{w as T,E as R,A as d}from"./index-Bf9NpXkZ.js";import{f as C}from"./dateUtil-ohqk8BGA.js";import{k as i,aX as D,bs as g,d as k,r as b,I as v,Q as P,aq as S,B as l,K as u,_ as A,ak as q,cn as N}from"./vendor-D7Y6X7_h.js";import{u as V}from"./dynamic-table-CtWW4hiU.js";import"./ApiSelect.vue_vue_type_script_setup_true_lang-BrXY2i5o.js";import"./index.vue_vue_type_style_index_0_lang-reX62h1K.js";import{u as $}from"./useFormModal-DrjhP41g.js";import"./schema-form.vue_vue_type_script_setup_true_lang-BWF4-paj.js";import"./is-CBsgbGQ7.js";import"./index-DKcumURF.js";import"./index-DaE14gLf.js";import"./Icon.vue_vue_type_script_setup_true_lang-B_bz3tPt.js";import"./useModal-p6LRjO4c.js";function E(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!g(e)}const f="字典项管理",F=e=>T.hasRoute(f)?i(R,{to:{name:f,params:{id:e.id}}},{default:()=>[e.code]}):e.code,L=[{title:"ID",dataIndex:"id",sorter:!0,width:60},{title:"字典名称",dataIndex:"name"},{title:"字典编码",dataIndex:"code",customRender:({record:e})=>i(F,e,null)},{title:"状态",dataIndex:"status",width:80,customRender:({record:e})=>{const o=~~e.status===1,c=o?"green":"red",n=o?"启用":"停用";return i(D,{color:c},E(n)?n:{default:()=>[n]})}},{title:"备注",dataIndex:"remark"},{title:"更新时间",dataIndex:"updatedAt",sorter:!0,width:160,customRender:({record:e})=>C(e.createdAt)}],M=[{field:"name",label:"字典名称",component:"Input",colProps:{span:8}},{field:"code",label:"字典编码",component:"Input",colProps:{span:8}}],j=[{field:"name",component:"Input",label:"字典名称",rules:[{required:!0,type:"string"}]},{field:"code",component:"Input",label:"字典编码",rules:[{required:!0,type:"string"}]},{field:"status",label:"状态",component:"RadioGroup",defaultValue:1,componentProps:{options:[{label:"启用",value:1},{label:"禁用",value:0}]}},{field:"remark",component:"InputTextArea",label:"备注",colProps:{span:24}}],te=k({name:"SystemDict",__name:"index",setup(e){const r=b({}),o=b({}),[c,n]=V({formProps:{schemas:M}}),[h]=$(),y=async t=>{const[s]=await h({modalProps:{title:`${t.id?"编辑":"新增"}字典`,width:"50%",onFinish:async a=>{t.id?await d.systemDictType.dictTypeUpdate({id:t.id},a):await d.systemDictType.dictTypeCreate(a),n?.reload()}},formProps:{labelWidth:120,schemas:j}});s?.setFieldsValue({...t})},I=async t=>{await d.systemDictType.dictTypeDelete({id:t.id}),n?.reload()},w=[...L,{title:"操作",width:130,dataIndex:"ACTION",hideInSearch:!0,fixed:"right",actions:({record:t})=>[{label:"编辑",auth:{perm:"system:dict-type:update",effect:"disable"},onClick:()=>y(t)},{label:"删除",auth:"system:dict-type:delete",popConfirm:{title:"你确定要删除吗？",placement:"left",onConfirm:()=>I(t)}}]}],x=async(t,s)=>{const a=s.id;if(t){o.value[a]=!0;const{items:m=[]}=await d.systemDictItem.dictItemList({typeId:a}).finally(()=>o.value[a]=!1);r.value[a]=m}};return(t,s)=>{const a=q("a-button"),m=N;return v(),P("div",null,[i(l(c),{"row-key":"id","header-title":"字典管理","data-request":l(d).systemDictType.dictTypeList,columns:w,bordered:"",size:"small",onExpand:x},S({toolbar:u(()=>[i(a,{type:"primary",disabled:!t.$auth("system:dict-type:create"),onClick:s[0]||(s[0]=p=>y({}))},{default:u(()=>[A(" 新增 ")]),_:1},8,["disabled"])]),_:2},[t.$router.hasRoute(l(f))?{name:"expandedRowRender",fn:u(({record:p})=>[i(m,{size:"small",columns:l(_),loading:o.value[p.id],"data-source":r.value[p.id],pagination:!1},null,8,["columns","loading","data-source"])]),key:"0"}:void 0]),1032,["data-request"])])}}});export{te as default};
